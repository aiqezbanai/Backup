<!DOCTYPE html>
<html lang="hy">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workflow Backup</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Crypto-JS for reliable MD5 hashing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col items-center justify-center min-h-screen p-4">

    <!-- Main Application Container -->
    <div class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-md space-y-6 text-center transition-all duration-300 transform scale-100 opacity-100">
        <h1 class="text-3xl font-bold text-gray-800">Workflow Backup</h1>
        <p class="text-gray-600">Հավելվածը հասանելի է միայն լիազորված օգտատերերի համար։</p>

        <!-- Main Action Buttons -->
        <div class="flex flex-col space-y-4">
            <!-- Login/Logout Button -->
            <button id="auth-button" class="w-full bg-blue-600 text-white font-semibold py-3 px-6 rounded-xl shadow-lg hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                Մուտք
            </button>

            <!-- Backup Upload Button (Disabled by default) -->
            <button id="upload-button" class="w-full bg-green-500 text-white font-semibold py-3 px-6 rounded-xl shadow-lg transition-colors duration-200 opacity-50 cursor-not-allowed" disabled>
                Backup Վերբեռնել
            </button>

            <!-- Backup Download Button (Disabled by default) -->
            <button id="download-button" class="w-full bg-purple-500 text-white font-semibold py-3 px-6 rounded-xl shadow-lg transition-colors duration-200 opacity-50 cursor-not-allowed" disabled>
                Backup Ներբեռնել
            </button>
        </div>
    </div>

    <!-- The POP-UP Modal for Login -->
    <div id="login-modal" class="modal-overlay hidden">
        <div class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-sm space-y-6 transform scale-95 transition-all duration-300">
            <h2 class="text-2xl font-bold text-gray-800 text-center">Մուտք Պահանջվում է</h2>
            <div class="text-center text-red-500 font-medium" id="error-message"></div>
            
            <input type="password" id="password-input" placeholder="Մուտքագրեք գաղտնաբառը" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200">
            
            <div class="flex justify-between space-x-4">
                <button id="cancel-button" class="flex-1 bg-gray-200 text-gray-700 font-semibold py-3 rounded-xl hover:bg-gray-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50">
                    Չեղարկել
                </button>
                <button id="login-button" class="flex-1 bg-blue-600 text-white font-semibold py-3 rounded-xl hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                    Մուտք Գործել
                </button>
            </div>
        </div>
    </div>

    <script>
        // DOM էլեմենտների հղումներ
        const authButton = document.getElementById('auth-button');
        const uploadButton = document.getElementById('upload-button');
        const downloadButton = document.getElementById('download-button');
        const loginModal = document.getElementById('login-modal');
        const passwordInput = document.getElementById('password-input');
        const loginButton = document.getElementById('login-button');
        const cancelButton = document.getElementById('cancel-button');
        const errorMessage = document.getElementById('error-message');

        // Նախապես հեշավորված MD5 գաղտնաբառ անվտանգ համեմատության համար
        // Օրիգինալ գաղտնաբառն է: Admin131100#Backup!!!
        const correctPasswordHash = "58fe89a9aef1bf3656bbcde9a15f09d0";

        // Օգտագործողի մուտքի կարգավիճակը հետևելու փոփոխական
        let isLoggedIn = false;

        // Ֆունկցիա՝ MD5 հեշավորմամբ տողը հեշավորելու համար
        function md5Hash(input) {
            // Օգտագործում ենք CryptoJS գրադարանի հուսալի ֆունկցիան
            return CryptoJS.MD5(input).toString();
        }

        // Ֆունկցիա՝ UI-ը թարմացնելու համար՝ հիմնվելով մուտքի կարգավիճակի վրա
        function updateUI() {
            if (isLoggedIn) {
                authButton.textContent = 'Ելք';
                authButton.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                authButton.classList.add('bg-red-600', 'hover:bg-red-700');
                
                uploadButton.disabled = false;
                uploadButton.classList.remove('opacity-50', 'cursor-not-allowed');
                uploadButton.classList.add('hover:bg-green-600');
                
                downloadButton.disabled = false;
                downloadButton.classList.remove('opacity-50', 'cursor-not-allowed');
                downloadButton.classList.add('hover:bg-purple-600');

                console.log("Մուտքը հաջողությամբ կատարվել է");
            } else {
                authButton.textContent = 'Մուտք';
                authButton.classList.remove('bg-red-600', 'hover:bg-red-700');
                authButton.classList.add('bg-blue-600', 'hover:bg-blue-700');
                
                uploadButton.disabled = true;
                uploadButton.classList.add('opacity-50', 'cursor-not-allowed');
                uploadButton.classList.remove('hover:bg-green-600');
                
                downloadButton.disabled = true;
                downloadButton.classList.add('opacity-50', 'cursor-not-allowed');
                downloadButton.classList.remove('hover:bg-purple-600');

                console.log("Ելքը հաջողությամբ կատարվել է");
            }
        }

        // Գլխավոր մուտքի/ելքի կոճակի իրադարձության լսող
        authButton.addEventListener('click', () => {
            if (isLoggedIn) {
                // Կատարել ելք
                isLoggedIn = false;
                updateUI();
            } else {
                // Ցույց տալ մուտքի մոդալը
                loginModal.classList.remove('hidden');
                passwordInput.value = ''; // Մաքրել մուտքագրման դաշտը
                errorMessage.textContent = ''; // Մաքրել սխալի հաղորդագրությունը
            }
        });

        // Մուտքի մոդալի ներսում գտնվող մուտքի կոճակի իրադարձության լսող
        loginButton.addEventListener('click', () => {
            // Մաքրել բացատները մուտքագրված գաղտնաբառից մինչև հեշավորումը
            const enteredPassword = passwordInput.value.trim();
            const enteredPasswordHash = md5Hash(enteredPassword);

            if (enteredPasswordHash === correctPasswordHash) {
                isLoggedIn = true;
                loginModal.classList.add('hidden');
                updateUI();
            } else {
                errorMessage.textContent = 'Սխալ գաղտնաբառ։ Փորձեք կրկին։';
                passwordInput.value = ''; // Մաքրել գաղտնաբառի դաշտը
            }
        });

        // Մոդալի ներսում գտնվող չեղարկման կոճակի իրադարձության լսող
        cancelButton.addEventListener('click', () => {
            loginModal.classList.add('hidden');
        });

        // Ֆունկցիոնալ կոճակների իրադարձության լսողներ (ցուցադրման համար)
        uploadButton.addEventListener('click', () => {
            if (isLoggedIn) {
                // Իրական հավելվածում սա կզբաղվեր պահեստային պատճենի վերբեռնման տրամաբանությամբ
                console.log("Backup Վերբեռնելու գործողությունը սկսվել է:");
            }
        });

        downloadButton.addEventListener('click', () => {
            if (isLoggedIn) {
                // Իրական հավելվածում սա կզբաղվեր պահեստային պատճենի ներբեռնման տրամաբանությամբ
                console.log("Backup Ներբեռնելու գործողությունը սկսվել է:");
            }
        });

        // Սկզբնական UI թարմացում էջը բեռնելիս
        updateUI();

    </script>
</body>
</html>




<!-- Հին Տարբերակ -->

<!--<!DOCTYPE html>
<html lang="hy">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Responsive Backup Հավելված</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4A90E2;
            --secondary-color: #50E3C2;
            --text-color: #333;
            --light-bg: #F4F6F9;
            --card-bg: #fff;
            --border-color: #E0E0E0;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --success-color: #4CAF50;
            --error-color: #F44336;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            background-color: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 24px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-danger {
            background-color: var(--error-color);
            color: white;
        }

        .btn-outline {
            background-color: transparent;
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.875rem;
        }

        .storage-info {
            display: flex;
            gap: 24px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .storage-card {
            flex: 1;
            background-color: var(--light-bg);
            padding: 16px;
            border-radius: 8px;
            text-align: center;
            min-width: 150px;
        }

        .storage-card h3 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #666;
        }

        .storage-card p {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .storage-bar {
            width: 100%;
            background-color: var(--border-color);
            height: 12px;
            border-radius: 6px;
            margin-top: 12px;
            overflow: hidden;
        }

        .storage-bar-fill {
            height: 100%;
            background-color: var(--primary-color);
            transition: width 0.5s ease;
        }

        .actions {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
            align-items: center;
        }

        .actions .btn {
            min-width: 150px;
        }

        .search-container {
            flex-grow: 1;
        }

        .search-container input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .search-container input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.2);
        }

        .backup-list-container {
            overflow-x: auto;
        }

        .backup-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }

        .backup-table th, .backup-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .backup-table th {
            font-size: 0.875rem;
            color: #888;
            text-transform: uppercase;
        }

        .backup-table tbody tr:hover {
            background-color: #F8F9FA;
        }

        .action-btns {
            display: flex;
            gap: 8px;
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }
            .storage-info {
                flex-direction: column;
            }
            .actions {
                flex-direction: column;
            }
            .actions .btn {
                width: 100%;
            }
            .search-container {
                width: 100%;
                margin-top: 16px;
            }
            .backup-table th, .backup-table td {
                padding: 8px;
                font-size: 0.75rem;
            }
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background-color: var(--card-bg);
            padding: 32px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            width: 90%;
            max-width: 400px;
            text-align: center;
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .modal.active {
            display: flex;
        }
        
        .modal.active .modal-content {
            transform: scale(1);
            opacity: 1;
        }

        .modal-content h3 {
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .modal-content input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* Notification Styles */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--primary-color);
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            z-index: 1001;
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .notification.success {
            background-color: var(--success-color);
        }

        .notification.error {
            background-color: var(--error-color);
        }

        .notification.show {
            display: block;
            opacity: 1;
        }

        .search-filter-container {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }
        .search-filter-container .search-container {
            margin-top: 0;
        }
        
        .storage-bar-container {
            margin-top: 16px;
        }
        
        .storage-info-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
        }
        
        .file-upload-input {
            display: none;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Պահուստային Կառավարում</h1>
        <button id="exitBtn" class="btn btn-outline">Ելք</button>
    </div>

    <div class="storage-info">
        <div class="storage-card">
            <h3>Օգտագործված ծավալ</h3>
            <p id="usedSpace">0 KB</p>
        </div>
        <div class="storage-card">
            <h3>Ազատ ծավալ</h3>
            <p id="freeSpace">128.00 TB</p>
        </div>
        <div class="storage-card" style="flex-grow: 2;">
            <h3>Ընդհանուր ծավալի օգտագործում</h3>
            <div class="storage-bar">
                <div id="storageBarFill" class="storage-bar-fill"></div>
            </div>
            <div class="storage-info-labels">
                <small id="usedPercentage">0%</small>
                <small>128.00 TB</small>
            </div>
        </div>
    </div>

    <div class="search-filter-container">
        <div class="actions">
            <button id="uploadBtn" class="btn btn-primary">Backup Upload</button>
            <button id="downloadAllBtn" class="btn btn-secondary">Backup Download</button>
            <input type="file" id="fileInput" class="file-upload-input" multiple>
        </div>
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Որոնել Backup...">
        </div>
    </div>

    <div class="backup-list-container">
        <table class="backup-table">
            <thead>
                <tr>
                    <th>No.</th>
                    <th>Անվանում</th>
                    <th>Ամսաթիվ</th>
                    <th>Ժամ</th>
                    <th>Ծավալ</th>
                    <th>Ֆորմատ</th>
                    <th>Գործողություն</th>
                </tr>
            </thead>
            <tbody id="backupTableBody">
                
            </tbody>
        </table>
    </div>

    <div class="notification" id="notification"></div>
</div>


<div id="passwordModal" class="modal">
    <div class="modal-content">
        <h3 id="passwordModalTitle">Մուտքագրեք գաղտնաբառը</h3>
        <input type="password" id="passwordInput" placeholder="Գաղտնաբառ">
        <div class="modal-buttons">
            <button id="cancelPasswordBtn" class="btn btn-outline">Չեղարկել</button>
            <button id="confirmPasswordBtn" class="btn btn-primary">Կատարել</button>
        </div>
    </div>
</div>


<div id="exitModal" class="modal">
    <div class="modal-content">
        <h3>Վստահ եք, որ ցանկանում եք դուրս գալ:</h3>
        <div class="modal-buttons">
            <button id="cancelExitBtn" class="btn btn-outline">Չեղարկել</button>
            <button id="confirmExitBtn" class="btn btn-danger">Դուրս գալ</button>
        </div>
    </div>
</div>

<script>
    // MD5 hashing library - 
    // This is a compact implementation of MD5.
    // NOTE: For true security, hashing and password verification should be done on a server (backend).
    // Storing the hash in the frontend code is a security risk.
    var md5 = function (string) {
        function RotateLeft(lValue, iShiftBits) {
            return (lValue << iShiftBits) | (lValue >>> (32 - iShiftBits));
        }
        function AddUnsigned(lX, lY) {
            var lX4 = (lX & 0x40000000), lY4 = (lY & 0x40000000), lX3 = (lX & 0x80000000), lY3 = (lY & 0x80000000), lResult = (lX & 0x3FFFFFFF) + (lY & 0x3FFFFFFF);
            if (lX4 & lY4) return (lResult ^ 0x80000000 ^ lX3 ^ lY3);
            if (lX4 | lY4) {
                if (lResult & 0x40000000) return (lResult ^ 0xC0000000 ^ lX3 ^ lY3);
                else return (lResult ^ 0x40000000 ^ lX3 ^ lY3);
            } else {
                return (lResult ^ lX3 ^ lY3);
            }
        }
        function F(x, y, z) { return (x & y) | ((~x) & z); }
        function G(x, y, z) { return (x & z) | (y & (~z)); }
        function H(x, y, z) { return (x ^ y ^ z); }
        function I(x, y, z) { return (y ^ (x | (~z))); }
        function FF(a, b, c, d, x, s, ac) { a = AddUnsigned(a, AddUnsigned(AddUnsigned(F(b, c, d), x), ac)); return AddUnsigned(RotateLeft(a, s), b); }
        function GG(a, b, c, d, x, s, ac) { a = AddUnsigned(a, AddUnsigned(AddUnsigned(G(b, c, d), x), ac)); return AddUnsigned(RotateLeft(a, s), b); }
        function HH(a, b, c, d, x, s, ac) { a = AddUnsigned(a, AddUnsigned(AddUnsigned(H(b, c, d), x), ac)); return AddUnsigned(RotateLeft(a, s), b); }
        function II(a, b, c, d, x, s, ac) { a = AddUnsigned(a, AddUnsigned(AddUnsigned(I(b, c, d), x), ac)); return AddUnsigned(RotateLeft(a, s), b); }
        function ConvertToWordArray(string) {
            var lWordCount;
            var lMessageLength = string.length;
            var lNumberOfWords_temp1 = lMessageLength + 8;
            var lNumberOfWords_temp2 = (lNumberOfWords_temp1 - (lNumberOfWords_temp1 % 64)) / 64;
            var lNumberOfWords = (lNumberOfWords_temp2 + 1) * 16;
            var lWordArray = Array(lNumberOfWords - 1);
            var lBytePosition = 0;
            var lByteCount = 0;
            while (lByteCount < lMessageLength) {
                lWordCount = (lByteCount - (lByteCount % 4)) / 4;
                lBytePosition = (lByteCount % 4) * 8;
                lWordArray[lWordCount] = lWordArray[lWordCount] | (string.charCodeAt(lByteCount) << lBytePosition);
                lByteCount++;
            }
            lWordCount = (lByteCount - (lByteCount % 4)) / 4;
            lBytePosition = (lByteCount % 4) * 8;
            lWordArray[lWordCount] = lWordArray[lWordCount] | (0x80 << lBytePosition);
            lWordArray[lNumberOfWords - 2] = lMessageLength << 3;
            lWordArray[lNumberOfWords - 1] = lMessageLength >>> 29;
            return lWordArray;
        }
        function WordToHex(lValue) {
            var WordToHexValue = "", WordToHexValue_temp = "", lByte, lCount;
            for (lCount = 0; lCount <= 3; lCount++) {
                lByte = (lValue >>> (lCount * 8)) & 255;
                WordToHexValue_temp = "0" + lByte.toString(16);
                WordToHexValue = WordToHexValue + WordToHexValue_temp.substr(WordToHexValue_temp.length - 2, 2);
            }
            return WordToHexValue;
        }
        var x = Array();
        var k, AA, BB, CC, DD, a, b, c, d;
        var S11 = 7, S12 = 12, S13 = 17, S14 = 22;
        var S21 = 5, S22 = 9, S23 = 14, S24 = 20;
        var S31 = 4, S32 = 11, S33 = 16, S34 = 23;
        var S41 = 6, S42 = 10, S43 = 15, S44 = 21;
        string = string;
        x = ConvertToWordArray(string);
        a = 0x67452301; b = 0xEFCDAB89; c = 0x98BADCFE; d = 0x10325476;
        for (k = 0; k < x.length; k += 16) {
            AA = a; BB = b; CC = c; DD = d;
            a = FF(a, b, c, d, x[k + 0], S11, 0xD76AA478); d = FF(d, a, b, c, x[k + 1], S12, 0xE8C7B756); c = FF(c, d, a, b, x[k + 2], S13, 0x242070DB); b = FF(b, c, d, a, x[k + 3], S14, 0xC1BDCEEE);
            a = FF(a, b, c, d, x[k + 4], S11, 0xF57C0FAF); d = FF(d, a, b, c, x[k + 5], S12, 0x4787C62A); c = FF(c, d, a, b, x[k + 6], S13, 0xA8304613); b = FF(b, c, d, a, x[k + 7], S14, 0xFD469501);
            a = FF(a, b, c, d, x[k + 8], S11, 0x698098D8); d = FF(d, a, b, c, x[k + 9], S12, 0x8B44F7AF); c = FF(c, d, a, b, x[k + 10], S13, 0xFFFF5BB1); b = FF(b, c, d, a, x[k + 11], S14, 0x895CD7BE);
            a = FF(a, b, c, d, x[k + 12], S11, 0x6B901122); d = FF(d, a, b, c, x[k + 13], S12, 0xFD987193); c = FF(c, d, a, b, x[k + 14], S13, 0xA679438E); b = FF(b, c, d, a, x[k + 15], S14, 0x49B40821);
            a = GG(a, b, c, d, x[k + 1], S21, 0xF61E2562); d = GG(d, a, b, c, x[k + 6], S22, 0xC040B340); c = GG(c, d, a, b, x[k + 11], S23, 0x265E5A51); b = GG(b, c, d, a, x[k + 0], S24, 0xE9B6C7AA);
            a = GG(a, b, c, d, x[k + 5], S21, 0xD62F105D); d = GG(d, a, b, c, x[k + 10], S22, 0x2441453); c = GG(c, d, a, b, x[k + 15], S23, 0xD8A1E681); b = GG(b, c, d, a, x[k + 4], S24, 0xE7D3FBC8);
            a = GG(a, b, c, d, x[k + 9], S21, 0x21E1CDE6); d = GG(d, a, b, c, x[k + 14], S22, 0xC33707D6); c = GG(c, d, a, b, x[k + 3], S23, 0xF4D50D87); b = GG(b, c, d, a, x[k + 8], S24, 0x455A14ED);
            a = GG(a, b, c, d, x[k + 13], S21, 0xA9E3E905); d = GG(d, a, b, c, x[k + 2], S22, 0xFCEFA3F8); c = GG(c, d, a, b, x[k + 7], S23, 0x676F02D9); b = GG(b, c, d, a, x[k + 12], S24, 0x8D2A4C8A);
            a = HH(a, b, c, d, x[k + 5], S31, 0xFFFA3942); d = HH(d, a, b, c, x[k + 8], S32, 0x8771F681); c = HH(c, d, a, b, x[k + 11], S33, 0x6D9D6122); b = HH(b, c, d, a, x[k + 14], S34, 0xFDE5380C);
            a = HH(a, b, c, d, x[k + 1], S31, 0xA4BEEA44); d = HH(d, a, b, c, x[k + 4], S32, 0x4BDECFA9); c = HH(c, d, a, b, x[k + 7], S33, 0xF6BB4B60); b = HH(b, c, d, a, x[k + 10], S34, 0xBEBFBC70);
            a = HH(a, b, c, d, x[k + 13], S31, 0x289B7EC6); d = HH(d, a, b, c, x[k + 0], S32, 0xEAA127FA); c = HH(c, d, a, b, x[k + 3], S33, 0xD4EF3085); b = HH(b, c, d, a, x[k + 6], S34, 0x4881D05);
            a = HH(a, b, c, d, x[k + 9], S31, 0xD9D4D039); d = HH(d, a, b, c, x[k + 12], S32, 0xE6DB99E5); c = HH(c, d, a, b, x[k + 15], S33, 0x1FA27CF8); b = HH(b, c, d, a, x[k + 2], S34, 0xC4AC5665);
            a = II(a, b, c, d, x[k + 0], S41, 0xF4292244); d = II(d, a, b, c, x[k + 7], S42, 0x432AFF97); c = II(c, d, a, b, x[k + 14], S43, 0xAB9423A7); b = II(b, c, d, a, x[k + 5], S44, 0xFC93A039);
            a = II(a, b, c, d, x[k + 12], S41, 0x655B59C3); d = II(d, a, b, c, x[k + 3], S42, 0x8F0CCC92); c = II(c, d, a, b, x[k + 10], S43, 0xFFEFF47D); b = II(b, c, d, a, x[k + 1], S44, 0x85845DD1);
            a = II(a, b, c, d, x[k + 8], S41, 0x6FA87E4F); d = II(d, a, b, c, x[k + 15], S42, 0xFE2CE6E0); c = II(c, d, a, b, x[k + 6], S43, 0xA3014314); b = II(b, c, d, a, x[k + 13], S44, 0x4E0811A1);
            a = II(a, b, c, d, x[k + 4], S41, 0xF7537E82); d = II(d, a, b, c, x[k + 11], S42, 0xBD3AF235); c = II(c, d, a, b, x[k + 2], S43, 0x2AD7D2BB); b = II(b, c, d, a, x[k + 9], S44, 0xEB86D391);
            a = AddUnsigned(a, AA); b = AddUnsigned(b, BB); c = AddUnsigned(c, CC); d = AddUnsigned(d, DD);
        }
        return (WordToHex(a) + WordToHex(b) + WordToHex(c) + WordToHex(d)).toLowerCase();
    };

    const TOTAL_SPACE_BYTES = 128 * 1024 * 1024 * 1024 * 1024; // 128 TB in bytes
    const HASHED_PASSWORD = 'f89e2467d589f2a40a8d6e992167d300'; // MD5 hash of "Admin131100#Backup!!!"
    const allowedFormats = ['.txt', '.json', '.xml', '.csv'];

    const elements = {
        usedSpace: document.getElementById('usedSpace'),
        freeSpace: document.getElementById('freeSpace'),
        storageBarFill: document.getElementById('storageBarFill'),
        usedPercentage: document.getElementById('usedPercentage'),
        exitBtn: document.getElementById('exitBtn'),
        uploadBtn: document.getElementById('uploadBtn'),
        downloadAllBtn: document.getElementById('downloadAllBtn'),
        fileInput: document.getElementById('fileInput'),
        searchInput: document.getElementById('searchInput'),
        backupTableBody: document.getElementById('backupTableBody'),
        passwordModal: document.getElementById('passwordModal'),
        passwordModalTitle: document.getElementById('passwordModalTitle'),
        passwordInput: document.getElementById('passwordInput'),
        cancelPasswordBtn: document.getElementById('cancelPasswordBtn'),
        confirmPasswordBtn: document.getElementById('confirmPasswordBtn'),
        exitModal: document.getElementById('exitModal'),
        cancelExitBtn: document.getElementById('cancelExitBtn'),
        confirmExitBtn: document.getElementById('confirmExitBtn'),
        notification: document.getElementById('notification')
    };

    let backups = [];
    let currentCallback = null;

    // Utility function to format bytes into a readable string
    function formatBytes(bytes) {
        if (bytes === 0) return '0 B';
        const units = ['B', 'KB', 'MB', 'GB', 'TB'];
        const i = Math.floor(Math.log(bytes) / Math.log(1024));
        return parseFloat((bytes / Math.pow(1024, i)).toFixed(2)) + ' ' + units[i];
    }

    // Function to show a notification
    function showNotification(message, type = 'success') {
        const notification = elements.notification;
        notification.textContent = message;
        notification.className = `notification show ${type}`;
        setTimeout(() => {
            notification.className = 'notification';
        }, 4000); // Hide after 4 seconds
    }

    // Function to calculate and update storage info
    function updateStorageInfo() {
        const usedBytes = backups.reduce((sum, backup) => sum + backup.size, 0);
        const freeBytes = TOTAL_SPACE_BYTES - usedBytes;
        const usedPercentage = (usedBytes / TOTAL_SPACE_BYTES) * 100;

        elements.usedSpace.textContent = formatBytes(usedBytes);
        elements.freeSpace.textContent = formatBytes(freeBytes);
        elements.storageBarFill.style.width = `${Math.min(usedPercentage, 100)}%`;
        elements.usedPercentage.textContent = `${usedPercentage.toFixed(2)}%`;

        if (usedBytes > TOTAL_SPACE_BYTES) {
            showNotification('Զգուշացում: Տվյալների ծավալը գերազանցել է տրամադրված ծավալը:', 'error');
        }
    }

    // Function to render backup list
    function renderBackups(filter = '') {
        const filteredBackups = backups.filter(backup =>
            backup.name.toLowerCase().includes(filter.toLowerCase())
        );
        elements.backupTableBody.innerHTML = '';
        if (filteredBackups.length === 0) {
            elements.backupTableBody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #888;">Պահուստային ֆայլեր չկան։</td></tr>';
            return;
        }

        filteredBackups.forEach((backup, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${index + 1}</td>
                <td>${backup.name}</td>
                <td>${backup.date}</td>
                <td>${backup.time}</td>
                <td>${formatBytes(backup.size)}</td>
                <td>${backup.format}</td>
                <td class="action-btns">
                    <button class="btn btn-primary btn-small" onclick="downloadFile('${backup.id}')">Ներբեռնել</button>
                    <button class="btn btn-danger btn-small" onclick="deleteFile('${backup.id}')">Ջնջել</button>
                </td>
            `;
            elements.backupTableBody.appendChild(row);
        });
    }

    // Function to save backups to localStorage
    function saveBackups() {
        try {
            localStorage.setItem('backups', JSON.stringify(backups));
        } catch (e) {
            showNotification('LocalStorage-ի պահուստը լիքն է կամ սահմանափակված է:', 'error');
        }
    }

    // Function to load backups from localStorage
    function loadBackups() {
        const storedBackups = localStorage.getItem('backups');
        if (storedBackups) {
            backups = JSON.parse(storedBackups);
        }
    }

    // Function to show password modal
    function showPasswordPrompt(callback) {
        currentCallback = callback;
        elements.passwordInput.value = '';
        elements.passwordModal.classList.add('active');
    }

    // Password confirmation logic
    elements.confirmPasswordBtn.addEventListener('click', () => {
        const password = elements.passwordInput.value;
        const enteredHash = md5(password);
        if (enteredHash === HASHED_PASSWORD) {
            elements.passwordModal.classList.remove('active');
            if (currentCallback) {
                currentCallback();
            }
        } else {
            showNotification('Սխալ գաղտնաբառ։', 'error');
            elements.passwordInput.value = '';
        }
    });

    elements.cancelPasswordBtn.addEventListener('click', () => {
        elements.passwordModal.classList.remove('active');
        showNotification('Գործողությունը չեղարկվեց։', 'error');
        currentCallback = null;
    });

    // Handle Backup Upload
    elements.uploadBtn.addEventListener('click', () => {
        showPasswordPrompt(() => {
            elements.fileInput.click();
        });
    });

    elements.fileInput.addEventListener('change', (event) => {
        const files = event.target.files;
        if (files.length === 0) {
            return;
        }

        Array.from(files).forEach(file => {
            const fileNameParts = file.name.split('.');
            const fileExtension = '.' + fileNameParts[fileNameParts.length - 1].toLowerCase();

            if (!allowedFormats.includes(fileExtension)) {
                showNotification(`Անթույլատրելի ֆայլի ֆորմատ: ${fileExtension}`, 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                const content = e.target.result;
                const newBackup = {
                    id: Date.now(),
                    name: file.name,
                    date: new Date().toLocaleDateString('hy-AM'),
                    time: new Date().toLocaleTimeString('hy-AM'),
                    size: content.length,
                    format: fileExtension,
                    content: btoa(content) // Base64 encode to store as a string in localStorage
                };

                backups.push(newBackup);
                saveBackups();
                renderBackups(elements.searchInput.value);
                updateStorageInfo();
                showNotification(`"${file.name}" ֆայլը հաջողությամբ վերբեռնվեց։`, 'success');
            };
            reader.readAsBinaryString(file);
        });
        elements.fileInput.value = ''; // Reset file input
    });

    // Handle single file download from the list
    function downloadFile(id) {
        showPasswordPrompt(() => {
            const backup = backups.find(b => b.id === parseInt(id));
            if (!backup) {
                showNotification('Ֆայլը չգտնվեց:', 'error');
                return;
            }

            const content = atob(backup.content); // Decode from Base64
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = backup.name;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showNotification(`"${backup.name}" ֆայլը հաջողությամբ ներբեռնվեց։`, 'success');
        });
    }

    // Handle bulk download (placeholder for a real-world scenario)
    elements.downloadAllBtn.addEventListener('click', () => {
        showPasswordPrompt(() => {
            if (backups.length === 0) {
                showNotification('Ներբեռնելու համար ֆայլեր չկան։', 'error');
                return;
            }
            // In a real-world scenario, this would create a ZIP file.
            // For a purely client-side solution, this is complex.
            // We will just show a notification.
            showNotification('Բոլոր պահուստային ֆայլերի ներբեռնումը հաջողությամբ ավարտվեց։', 'success');
        });
    });


    // Handle file deletion from the list
    function deleteFile(id) {
        showPasswordPrompt(() => {
            const initialLength = backups.length;
            backups = backups.filter(b => b.id !== parseInt(id));
            if (backups.length < initialLength) {
                saveBackups();
                renderBackups(elements.searchInput.value);
                updateStorageInfo();
                showNotification('Ֆայլը հաջողությամբ ջնջվեց։', 'success');
            } else {
                showNotification('Ֆայլը չգտնվեց։', 'error');
            }
        });
    }

    // Handle search input
    elements.searchInput.addEventListener('input', (e) => {
        renderBackups(e.target.value);
    });

    // Handle Exit button click
    elements.exitBtn.addEventListener('click', () => {
        elements.exitModal.classList.add('active');
    });

    // Handle Exit modal buttons
    elements.cancelExitBtn.addEventListener('click', () => {
        elements.exitModal.classList.remove('active');
    });

    elements.confirmExitBtn.addEventListener('click', () => {
        elements.exitModal.classList.remove('active');
        localStorage.clear();
        backups = [];
        renderBackups();
        updateStorageInfo();
        showNotification('Դուք դուրս եկաք։ Տվյալները մաքրվեցին։', 'success');
    });

    // Expose functions to the global scope for event handlers in the table
    window.downloadFile = downloadFile;
    window.deleteFile = deleteFile;

    // Initialize the app on page load
    window.onload = () => {
        loadBackups();
        renderBackups();
        updateStorageInfo();
    };
</script>

</body>
</html> -->
